<%# 
  SWOOSH Bot 3D Admin Dashboard
  Premium Edition - Â£50,000 Value
  
  Main dashboard page with 3D visualizations and server statistics
%>

<div class="admin3d-dashboard" data-realtime="true">
  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <h1 class="section-title">Admin Dashboard</h1>
    <div class="premium-price-tag"></div>
  </div>
  
  <p class="section-description">
    Welcome to the premium 3D admin dashboard. Control your Discord bot with advanced visualizations and real-time statistics.
  </p>
  
  <!-- Stats Overview -->
  <div class="stats-overview">
    <!-- Server Count -->
    <div class="stat-card" data-premium="true">
      <div class="stat-header">
        <div class="stat-title">Servers</div>
        <div class="stat-icon">
          <i class="fas fa-server"></i>
        </div>
      </div>
      <div class="stat-value" id="server-count">
        <%= client ? client.guilds.cache.size : 0 %>
      </div>
      <div class="stat-change positive">
        <i class="fas fa-arrow-up"></i>
        <span>Active</span>
      </div>
    </div>
    
    <!-- User Count -->
    <div class="stat-card">
      <div class="stat-header">
        <div class="stat-title">Users</div>
        <div class="stat-icon">
          <i class="fas fa-users"></i>
        </div>
      </div>
      <div class="stat-value" id="user-count">
        <% 
          let userCount = 0;
          if (client) {
            client.guilds.cache.forEach(guild => {
              userCount += guild.memberCount;
            });
          }
        %>
        <%= userCount %>
      </div>
    </div>
    
    <!-- Memory Usage -->
    <div class="stat-card" data-premium="true">
      <div class="stat-header">
        <div class="stat-title">Memory Usage</div>
        <div class="stat-icon">
          <i class="fas fa-memory"></i>
        </div>
      </div>
      <div class="stat-value" id="memory-usage">
        <% 
          const memoryUsage = process.memoryUsage();
          const totalMemory = require('os').totalmem();
          const usedMemoryPercent = Math.round((memoryUsage.rss / totalMemory) * 100);
        %>
        <%= usedMemoryPercent %>%
      </div>
      <div class="stat-progress">
        <div class="stat-progress-bar" id="memory-progress" style="width: <%= usedMemoryPercent %>%; background-color: <%= usedMemoryPercent > 90 ? 'var(--danger)' : (usedMemoryPercent > 70 ? 'var(--warning)' : 'var(--success)') %>;"></div>
      </div>
    </div>
    
    <!-- CPU Usage -->
    <div class="stat-card">
      <div class="stat-header">
        <div class="stat-title">CPU Usage</div>
        <div class="stat-icon">
          <i class="fas fa-microchip"></i>
        </div>
      </div>
      <div class="stat-value" id="cpu-usage">
        <% 
          // This is just an initial value, will be updated via WebSocket
          const initialCpuUsage = 0;
        %>
        <%= initialCpuUsage %>%
      </div>
      <div class="stat-progress">
        <div class="stat-progress-bar" id="cpu-progress" style="width: <%= initialCpuUsage %>%; background-color: var(--success);"></div>
      </div>
    </div>
    
    <!-- Uptime -->
    <div class="stat-card" data-premium="true">
      <div class="stat-header">
        <div class="stat-title">Uptime</div>
        <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
      </div>
      <div class="stat-value medium" id="uptime">
        <% 
          const uptime = process.uptime();
          const days = Math.floor(uptime / 86400);
          const hours = Math.floor((uptime % 86400) / 3600);
          const minutes = Math.floor((uptime % 3600) / 60);
          const seconds = Math.floor(uptime % 60);
          
          const uptimeStr = [
            days > 0 ? `${days}d` : '',
            hours > 0 || days > 0 ? `${hours}h` : '',
            minutes > 0 || hours > 0 || days > 0 ? `${minutes}m` : '',
            `${seconds}s`
          ].filter(Boolean).join(' ');
        %>
        <%= uptimeStr %>
      </div>
    </div>
  </div>
  
  <!-- Command Categories -->
  <h2 class="section-subtitle">Quick Access</h2>
  <div class="admin3d-cards">
    <!-- Moderation Card -->
    <div class="admin3d-card">
      <div class="admin3d-card-header">
        <div>
          <div class="admin3d-card-icon">
            <i class="fas fa-gavel"></i>
          </div>
        </div>
        <h3 class="admin3d-card-title">Moderation</h3>
      </div>
      <div class="admin3d-card-content">
        <p class="admin3d-card-description">
          Manage users with ban, kick, and mute commands. View moderation logs and user information.
        </p>
      </div>
      <div class="admin3d-card-actions">
        <a href="/admin3d/moderation" class="admin3d-btn admin3d-btn-primary">
          <i class="fas fa-arrow-right"></i> Manage
        </a>
      </div>
    </div>
    
    <!-- Messages Card -->
    <div class="admin3d-card" data-premium="true">
      <div class="admin3d-card-header">
        <div>
          <div class="admin3d-card-icon">
            <i class="fas fa-envelope"></i>
          </div>
        </div>
        <h3 class="admin3d-card-title">Messages</h3>
      </div>
      <div class="admin3d-card-content">
        <p class="admin3d-card-description">
          Send news updates, announcements, and embeds to any channel using the bot.
        </p>
      </div>
      <div class="admin3d-card-actions">
        <a href="/admin3d/messages" class="admin3d-btn admin3d-btn-primary">
          <i class="fas fa-arrow-right"></i> Manage
        </a>
      </div>
    </div>
    
    <!-- Tickets Card -->
    <div class="admin3d-card">
      <div class="admin3d-card-header">
        <div>
          <div class="admin3d-card-icon">
            <i class="fas fa-ticket-alt"></i>
          </div>
        </div>
        <h3 class="admin3d-card-title">Tickets</h3>
      </div>
      <div class="admin3d-card-content">
        <p class="admin3d-card-description">
          Manage support tickets, view transcripts, and configure the ticket system.
        </p>
      </div>
      <div class="admin3d-card-actions">
        <a href="/admin3d/tickets" class="admin3d-btn admin3d-btn-primary">
          <i class="fas fa-arrow-right"></i> Manage
        </a>
      </div>
    </div>
    
    <!-- Roles Card -->
    <div class="admin3d-card">
      <div class="admin3d-card-header">
        <div>
          <div class="admin3d-card-icon">
            <i class="fas fa-user-tag"></i>
          </div>
        </div>
        <h3 class="admin3d-card-title">Roles</h3>
      </div>
      <div class="admin3d-card-content">
        <p class="admin3d-card-description">
          Manage server roles, configure autoroles, and assign roles to users.
        </p>
      </div>
      <div class="admin3d-card-actions">
        <a href="/admin3d/roles" class="admin3d-btn admin3d-btn-primary">
          <i class="fas fa-arrow-right"></i> Manage
        </a>
      </div>
    </div>
    
    <!-- Commands Card -->
    <div class="admin3d-card" data-premium="true">
      <div class="admin3d-card-header">
        <div>
          <div class="admin3d-card-icon">
            <i class="fas fa-terminal"></i>
          </div>
        </div>
        <h3 class="admin3d-card-title">Commands</h3>
      </div>
      <div class="admin3d-card-content">
        <p class="admin3d-card-description">
          View and manage available commands. Execute commands directly from the dashboard.
        </p>
      </div>
      <div class="admin3d-card-actions">
        <a href="/admin3d/commands" class="admin3d-btn admin3d-btn-primary">
          <i class="fas fa-arrow-right"></i> Manage
        </a>
      </div>
    </div>
    
    <!-- Blacklist Card -->
    <div class="admin3d-card">
      <div class="admin3d-card-header">
        <div>
          <div class="admin3d-card-icon">
            <i class="fas fa-ban"></i>
          </div>
        </div>
        <h3 class="admin3d-card-title">Blacklist</h3>
      </div>
      <div class="admin3d-card-content">
        <p class="admin3d-card-description">
          Manage blacklisted users and view blacklist history. Set blacklist durations and reasons.
        </p>
      </div>
      <div class="admin3d-card-actions">
        <a href="/admin3d/blacklist" class="admin3d-btn admin3d-btn-primary">
          <i class="fas fa-arrow-right"></i> Manage
        </a>
      </div>
    </div>
  </div>

  <!-- Bot Status -->
  <h2 class="section-subtitle">Bot Status</h2>
  <div class="admin3d-status-card">
    <div class="status-header">
      <h3 class="status-title">SWOOSH Bot Status</h3>
      <div class="status-indicator <%= client ? 'online' : 'offline' %>">
        <i class="fas fa-circle"></i>
        <span><%= client ? 'Online' : 'Offline' %></span>
      </div>
    </div>
    <div class="status-content">
      <% if (client) { %>
        <div class="status-info">
          <div class="status-item">
            <span class="status-label">Username:</span>
            <span class="status-value"><%= client.user.tag %></span>
          </div>
          <div class="status-item">
            <span class="status-label">ID:</span>
            <span class="status-value"><%= client.user.id %></span>
          </div>
          <div class="status-item">
            <span class="status-label">Servers:</span>
            <span class="status-value"><%= client.guilds.cache.size %></span>
          </div>
          <div class="status-item">
            <span class="status-label">Commands:</span>
            <span class="status-value"><%= client.commands.size + client.slashCommands.size %></span>
          </div>
        </div>
      <% } else { %>
        <div class="status-offline-message">
          <i class="fas fa-exclamation-triangle"></i>
          <p>The bot is currently offline. Check the logs for more information.</p>
        </div>
      <% } %>
    </div>
  </div>
</div>

<style>
  .admin3d-status-card {
    background: rgba(19, 16, 58, 0.4);
    border-radius: 16px;
    border: 1px solid rgba(49, 41, 95, 0.3);
    margin-top: 2rem;
    overflow: hidden;
  }
  
  .status-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid rgba(49, 41, 95, 0.3);
  }
  
  .status-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0;
  }
  
  .status-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 100px;
    font-size: 0.875rem;
    font-weight: 600;
  }
  
  .status-indicator.online {
    background-color: rgba(0, 230, 118, 0.1);
    color: var(--success);
  }
  
  .status-indicator.online i {
    color: var(--success);
  }
  
  .status-indicator.offline {
    background-color: rgba(255, 61, 113, 0.1);
    color: var(--danger);
  }
  
  .status-indicator.offline i {
    color: var(--danger);
  }
  
  .status-content {
    padding: 1.5rem;
  }
  
  .status-info {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1.5rem;
  }
  
  .status-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .status-label {
    font-size: 0.875rem;
    color: var(--text-muted);
  }
  
  .status-value {
    font-size: 1.125rem;
    font-weight: 600;
  }
  
  .status-offline-message {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background-color: rgba(255, 61, 113, 0.1);
    border-radius: 8px;
    color: var(--danger);
  }
  
  .status-offline-message i {
    font-size: 1.5rem;
  }
  
  /* Stats progress bar */
  .stat-progress {
    height: 6px;
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    overflow: hidden;
    margin-top: 0.5rem;
  }
  
  .stat-progress-bar {
    height: 100%;
    border-radius: 3px;
    transition: width 0.5s ease;
  }
  
  /* Responsive styles */
  @media (max-width: 768px) {
    .status-info {
      grid-template-columns: 1fr 1fr;
    }
  }
  
  @media (max-width: 576px) {
    .status-info {
      grid-template-columns: 1fr;
    }
    
    .status-header {
      flex-direction: column;
      gap: 1rem;
      align-items: flex-start;
    }
  }
</style>